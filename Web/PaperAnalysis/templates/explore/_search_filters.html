<!-- ÊêúÁ¥¢ÂíåËøáÊª§Âô®ÁªÑ‰ª∂ -->
<div class="search-container">
    <form method="GET" action="{{ url_for('explore.papers') }}" id="searchForm">
        <div class="card mb-3">
            <div class="card-body py-3">
                <!-- ‰∏ªÊêúÁ¥¢Ë°å -->
                <div class="row mb-3">
                    <div class="col-md-8">
                        <label for="searchInput" class="form-label fw-bold">
                            <i class="bi bi-search"></i> ÊêúÁ¥¢ÂÖ≥ÈîÆËØç
                        </label>
                        <div class="input-group">
                            <input type="text" class="form-control search-input" id="searchInput" 
                                   name="q" value="{{ query }}" 
                                   placeholder="ÊêúÁ¥¢Ê†áÈ¢ò„ÄÅÊëòË¶Å„ÄÅ‰ΩúËÄÖ„ÄÅÁ†îÁ©∂ÁõÆÊ†áÊàñÂÖ≥ÈîÆËØç..."
                                   data-bs-toggle="tooltip" 
                                   data-bs-placement="top" 
                                   title="ÊîØÊåÅÊ®°Á≥äÊêúÁ¥¢ÔºåÂèØÊêúÁ¥¢Ê†áÈ¢ò„ÄÅÊëòË¶Å„ÄÅ‰ΩúËÄÖ„ÄÅÁ†îÁ©∂ÁõÆÊ†áÂíåÂÖ≥ÈîÆËØç">
                            <button class="btn btn-primary" type="submit">
                                <i class="bi bi-search"></i> ÊêúÁ¥¢
                            </button>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-bold">
                            <i class="bi bi-gear-wide-connected"></i> Âø´ÈÄüÊìç‰Ωú
                        </label>
                        <div class="d-flex gap-2">
                            <a href="{{ url_for('explore.papers') }}" class="btn btn-outline-secondary">
                                <i class="bi bi-arrow-counterclockwise"></i> Ê∏ÖÈô§ËøáÊª§
                            </a>
                            <button type="button" class="btn btn-outline-info" onclick="exportData('json')">
                                <i class="bi bi-download"></i> ÂØºÂá∫ÁªìÊûú
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- ËøáÊª§Âô®Ê†áÁ≠æË°å -->
                <div class="row g-2 mb-1">
                    <div class="col-md-3">
                        <label for="taskNameFilter" class="form-label mb-1">
                            <i class="bi bi-briefcase"></i> ‰ªªÂä°ÂêçÁß∞
                        </label>
                    </div>
                    <div class="col-md-3">
                        <label for="statusFilter" class="form-label mb-1">
                            <i class="bi bi-gear"></i> Â§ÑÁêÜÁä∂ÊÄÅ
                        </label>
                    </div>
                    <div class="col-md-3">
                        <label for="taskIdFilter" class="form-label mb-1">
                            <i class="bi bi-hash"></i> ‰ªªÂä°ID
                        </label>
                    </div>
                    <div class="col-md-3">
                        <label for="categoryFilter" class="form-label mb-1">
                            <i class="bi bi-tag"></i> ÂàÜÁ±ª
                        </label>
                    </div>
                </div>
                
                <!-- ËøáÊª§Âô®Êéß‰ª∂Ë°å -->
                <div class="row g-2">
                    <!-- ‰ªªÂä°ÂêçÁß∞ËøáÊª§ -->
                    <div class="col-md-3">
                        <select class="selectpicker" id="taskNameFilter" name="task_name" 
                                multiple 
                                data-live-search="true" 
                                data-actions-box="true"
                                data-selected-text-format="count > 2"
                                data-count-selected-text="{0} ‰∏™‰ªªÂä°Â∑≤ÈÄâÊã©"
                                data-none-selected-text="ÈÄâÊã©‰ªªÂä°Á≠õÈÄâ..."
                                data-select-all-text="ÈÄâÊã©ÂÖ®ÈÉ®"
                                data-deselect-all-text="ÂèñÊ∂àÂÖ®ÈÉ®"
                                title="ÈÄâÊã©‰ªªÂä°Á≠õÈÄâ...">
                            <option value="Êú™ÂàÜÈÖç‰ªªÂä°" {% if 'Êú™ÂàÜÈÖç‰ªªÂä°' in task_names %}selected{% endif %}>
                                üìå Êú™ÂàÜÈÖç‰ªªÂä°
                            </option>
                            {% for task_name in all_task_names %}
                            <option value="{{ task_name }}" {% if task_name in task_names %}selected{% endif %}>
                                {{ task_name }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <!-- Áä∂ÊÄÅËøáÊª§ -->
                    <div class="col-md-3">
                        <select class="form-select" id="statusFilter" name="status">
                            <option value="">ÂÖ®ÈÉ®Áä∂ÊÄÅ</option>
                            <option value="pending" {% if status == 'pending' %}selected{% endif %}>ÂæÖÂ§ÑÁêÜ</option>
                            <option value="completed" {% if status == 'completed' %}selected{% endif %}>Â∑≤ÂÆåÊàê</option>
                            <option value="failed" {% if status == 'failed' %}selected{% endif %}>Â§±Ë¥•</option>
                        </select>
                    </div>
                    
                    <!-- ‰ªªÂä°IDËøáÊª§ -->
                    <div class="col-md-3">
                        <input type="text" class="form-control" id="taskIdFilter" 
                               name="task_id" value="{{ task_id }}" 
                               placeholder="‰ªªÂä°ID"
                               data-bs-toggle="tooltip" 
                               data-bs-placement="top" 
                               title="Êåâ‰ªªÂä°IDÁ≤æÁ°ÆËøáÊª§ËÆ∫Êñá">
                    </div>
                    
                    <!-- ÂàÜÁ±ªËøáÊª§ -->
                    <div class="col-md-3">
                        <input type="text" class="form-control" id="categoryFilter" 
                               name="category" value="{{ category }}" 
                               placeholder="Â¶Ç: cs.LG">
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>